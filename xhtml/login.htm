<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
	<title>Buy Online</title>
</head>

<body>
	<h3>Buy Online</h3>
	<h4>Customer Login</h4>
	<br/>
	<form onsubmit="return submitForm()">
		Email : <input id="email" type="text" name="email"><br><br>
		Password : <input id="password" type="password" name="password"><br><br>
		<input type="submit" value="Register">
		<p id="errorMessage"></p>
	</form>
</body>
<script type="text/javascript">	
	function submitForm() {
		var email = document.getElementById('email').value;
		var password = document.getElementById('password').value;

		if (email == '' || password == '') {	
			errorMessage.innerText = "All fields must be filled.";
			return false;
		}	

		var http = new XMLHttpRequest();
		var url = '../php/login.php';
		var params = 'email='+ email + '&password=' + password;

		http.open('POST', url, true);
			//Send the proper header information along with the request
			http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');

			http.onreadystatechange = function() {//Call a function when the state changes.
				if(http.readyState == 4 && http.status == 200) {
					localStorage.setItem('email', 'bruh');
					document.getElementById('errorMessage').innerText = http.responseText;
					window.location.href = 'buying.htm?email='+http.responseText;	
				} else if(http.readyState == 4 && http.status == 401) {				
					document.getElementById('errorMessage').innerText = 'Incorrect ID or Password';
				}
			}
			http.send(params);

			return false;
		}
	</script>
	</html>